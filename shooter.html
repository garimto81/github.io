<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>간단한 슈팅 게임</title>
    <style>
        body {
            margin: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #fff;
            font-family: sans-serif;
        }
        canvas {
            background: #111;
            border: 1px solid #333;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="info">← → 이동, 스페이스바 발사</div>
    <canvas id="game" width="400" height="600"></canvas>
    <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    const player = { x: canvas.width / 2, y: canvas.height - 40, w: 20, h: 20 };
    const bullets = [];
    const enemies = [];
    let left = false, right = false, shooting = false;
    let gameOver = false;
    let lastEnemyTime = 0;

    function spawnEnemy() {
        const x = Math.random() * (canvas.width - 30) + 15;
        enemies.push({ x, y: -20, w: 20, h: 20 });
    }

    function update(delta) {
        if (left) player.x -= 200 * delta;
        if (right) player.x += 200 * delta;
        player.x = Math.max(player.w/2, Math.min(canvas.width - player.w/2, player.x));

        if (shooting) {
            bullets.push({ x: player.x, y: player.y - player.h/2, r: 4 });
            shooting = false;
        }

        for (const b of bullets) b.y -= 300 * delta;
        for (const e of enemies) e.y += 100 * delta;

        // remove off-screen bullets/enemies
        for (let i = bullets.length -1; i >=0; i--) if (bullets[i].y < -10) bullets.splice(i,1);
        for (let i = enemies.length -1; i >=0; i--) if (enemies[i].y > canvas.height + 10) enemies.splice(i,1);

        // collision
        for (let i = enemies.length -1; i >=0; i--) {
            const e = enemies[i];
            for (let j = bullets.length -1; j >=0; j--) {
                const b = bullets[j];
                if (Math.abs(e.x - b.x) < (e.w/2) && Math.abs(e.y - b.y) < (e.h/2)) {
                    enemies.splice(i,1);
                    bullets.splice(j,1);
                    break;
                }
            }
            if (Math.abs(e.x - player.x) < (e.w/2 + player.w/2) && Math.abs(e.y - player.y) < (e.h/2 + player.h/2)) {
                gameOver = true;
            }
        }

        if (performance.now() - lastEnemyTime > 1000) {
            spawnEnemy();
            lastEnemyTime = performance.now();
        }
    }

    function draw() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        // player
        ctx.fillStyle = '#0f0';
        ctx.fillRect(player.x - player.w/2, player.y - player.h/2, player.w, player.h);
        // bullets
        ctx.fillStyle = '#ff0';
        for (const b of bullets) ctx.fillRect(b.x - b.r/2, b.y - b.r/2, b.r, b.r*2);
        // enemies
        ctx.fillStyle = '#f00';
        for (const e of enemies) ctx.fillRect(e.x - e.w/2, e.y - e.h/2, e.w, e.h);
        if (gameOver) {
            ctx.fillStyle = '#fff';
            ctx.textAlign = 'center';
            ctx.fillText('게임 오버! R 키로 재시작', canvas.width/2, canvas.height/2);
        }
    }

    let last = performance.now();
    function loop() {
        const now = performance.now();
        const delta = (now - last)/1000;
        last = now;
        if (!gameOver) update(delta);
        draw();
        requestAnimationFrame(loop);
    }

    document.addEventListener('keydown', e => {
        if (e.key === 'ArrowLeft') left = true;
        if (e.key === 'ArrowRight') right = true;
        if (e.key === ' ') shooting = true;
        if (e.key === 'r' || e.key === 'R') if (gameOver) {
            enemies.length = 0;
            bullets.length = 0;
            player.x = canvas.width / 2;
            gameOver = false;
        }
    });
    document.addEventListener('keyup', e => {
        if (e.key === 'ArrowLeft') left = false;
        if (e.key === 'ArrowRight') right = false;
    });

    loop();
    </script>
</body>
</html>
